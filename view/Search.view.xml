<mvc:View
    controllerName="sap_ui5.controller.Search"
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core">

    <Page
        title="{i18n>searchPageTitle}"
        busy="{state>/isLoading}">

        <content>

            <!-- FILTER BAR -->
            <VBox class="sapUiSmallMargin">

                <Toolbar>
                    <Title text="{i18n>filtersTitle}"/>
                    <ToolbarSpacer/>
                    <Button text="{i18n>createButton}" press=".onCreate"/>
                    <Button text="{i18n>copyButton}" press=".onCopy"/>
                </Toolbar>

                <MessageStrip
                    visible="{state>/loadError}"
                    type="Error"
                    showIcon="true"
                    text="{= ${state>/loadErrorMessage} || ${i18n>loadErrorMessage} }"
                    class="sapUiTinyMarginTop"/>

                <HBox class="sapUiSmallMarginTop" alignItems="Center" wrap="Wrap">

                    <Input
                        placeholder="{i18n>checklistIdPlaceholder}"
                        value="{state>/filterId}"
                        width="200px"/>

                    <Select
                        width="200px"
                        selectedKey="{state>/filterLpc}">
                        <items>
                            <core:Item key="" text="{i18n>allLpc}"/>
                            <core:Item key="L1" text="{i18n>lpcLow}"/>
                            <core:Item key="L2" text="{i18n>lpcMedium}"/>
                            <core:Item key="L3" text="{i18n>lpcHigh}"/>
                        </items>
                    </Select>

                    <!-- Custom filter checks -->
                    <SegmentedButton selectedKey="{state>/filterFailedChecks}">
                        <items>
                            <SegmentedButtonItem key="ALL" text="{i18n>allChecks}"/>
                            <SegmentedButtonItem key="TRUE" text="{i18n>hasFailed}"/>
                            <SegmentedButtonItem key="FALSE" text="{i18n>allPassed}"/>
                        </items>
                    </SegmentedButton>

                    <!-- Custom filter barriers -->
                    <SegmentedButton selectedKey="{state>/filterFailedBarriers}">
                        <items>
                            <SegmentedButtonItem key="ALL" text="{i18n>allBarriers}"/>
                            <SegmentedButtonItem key="TRUE" text="{i18n>hasFailed}"/>
                            <SegmentedButtonItem key="FALSE" text="{i18n>allPassed}"/>
                        </items>
                    </SegmentedButton>

                    <Button text="{i18n>searchButton}" press=".onSearch"/>
                </HBox>

            </VBox>

            <!-- TABLE -->
            <Table
                id="checkTable"
                busy="{state>/isLoading}"
                noDataText="{= ${state>/loadError} ? ${i18n>noDataLoadError} : ${i18n>noDataDefault} }"
                items="{
                    path: 'data>/checkLists'
                }"
                mode="SingleSelectMaster"
                itemPress=".onSelect">

                <columns>
                    <Column><Text text="{i18n>columnId}"/></Column>
                    <Column><Text text="{i18n>columnStatus}"/></Column>
                    <Column><Text text="{i18n>columnChecks}"/></Column>
                    <Column><Text text="{i18n>columnBarriers}"/></Column>
                    <Column><Text text="{i18n>columnObserver}"/></Column>
                </columns>

                <items>
                    <ColumnListItem type="Navigation">
                        <cells>
                            <Text text="{data>root/id}"/>
                            <ObjectStatus
                                text="{data>root/status}"
                                state="{
                                    path: 'data>root/status',
                                    formatter: '.formatStatus'
                                }"/>
                            <Text text="{data>root/successRateChecks}"/>
                            <Text text="{data>root/successRateBarriers}"/>
                            <Text text="{data>basic/OBSERVER_FULLNAME}"/>
                        </cells>
                    </ColumnListItem>
                </items>

            </Table>

        </content>
    </Page>
</mvc:View>
